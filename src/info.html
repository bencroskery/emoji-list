<link rel="import" href="../bower_components/polymer/polymer.html">

<dom-module id="emoji-info">

  <template>

    <style>
      .info {
        text-align: center;
        font-size: calc(2em + 4vw);
      }
      .emoji {
        width: 64px;
      }
    </style>

    <app-route route="{{route}}" pattern="/:id" data="{{sub}}"></app-route>

    <div class="info">
      <div style="font-size: 64px">{{getEmoji(response, sub.id)}}</div>
      <div>{{getName(response, sub.id)}}</div>
      
      <template is="dom-repeat" items="{{getImages(response, sub.id)}}">
        <img class="emoji" src="{{item}}"/>
      </template>
    </div>

  </template>

  <script>

    Polymer({

      is: 'emoji-info',

      properties: {
        response: {
          value: null,
          notify: true
        },
        route: {
          type: Object,
          notify: true
        }
      },

      _Prop: function(r, i, p) {
        if (i !== -1)
          return r[i][p]
      },

      getEmoji: function(response, index) {
        let i = decodeURIComponent(index);
        const el = response.findIndex(function(e) {
          return e.brow.indexOf(i) !== -1;
        });

        return this._Prop(response, el, 'brow')
      },

      getName: function(response, index) {
        let i = decodeURIComponent(index);
        const el = response.findIndex(function(e) {
          return e.brow.indexOf(i) !== -1;
        });

        return this._Prop(response, el, 'name')
      },

      getImages: function(response, index) {
        let i = decodeURIComponent(index);
        const el = response.findIndex(function(e) {
          return e.brow.indexOf(i) !== -1;
        });

        const props = ['apple', 'goog', 'twtr', 'fbm'];
        let out = [];
        let a = this._Prop;
        props.forEach(function(p) {
          const o = a(response, el, p);
          if (o)
            out.push(o);
        });
        return out;
      },

      log: function(a) {
        console.log(a)
      }

    });

  </script>

</dom-module>
